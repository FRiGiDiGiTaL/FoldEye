"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{2818:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var r=a(7876),s=a(4232),n=a(8847),i=a.n(n);let l=i()(()=>a.e(844).then(a.bind(a,9844)).then(e=>({default:e.ControlPanel})),{loadableGenerated:{webpack:()=>[9844]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"w-full md:w-96 glass-panel-dark p-4 flex-shrink-0 shadow-2xl",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-700 rounded mb-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"h-16 bg-gray-700 rounded"}),(0,r.jsx)("div",{className:"h-12 bg-gray-700 rounded"}),(0,r.jsx)("div",{className:"h-12 bg-gray-700 rounded"})]})]})})}),c=i()(()=>a.e(900).then(a.bind(a,9900)).then(e=>({default:e.CameraView})),{loadableGenerated:{webpack:()=>[9900]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"flex-1 bg-gradient-to-b from-black via-gray-900 to-black flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-white text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-400 border-t-transparent mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-xl",children:"Loading AR Camera..."})]})})}),d=e=>{let t=e.split("\n"),a=new Map,r=0,s=/^\s*(\d+(?:-\d+)?(?:,\s*\d+(?:-\d+)?)*)\s+([0-9.,\s]+)/;for(let e of t){let t=e.trim();if(t.startsWith("#")||t.startsWith("PAGE")||""===t)continue;let n=t.match(s);if(!n)continue;let i=n[1],l=n[2].trim().replace(/,\s*$/,""),c=[];for(let e of i.replace(/\s/g,"").split(","))if(e.includes("-")){let[t]=e.split("-"),a=parseInt(t,10);isNaN(a)||a%2==0||c.push(a)}else{let t=parseInt(e,10);isNaN(t)||t%2==0||c.push(t)}for(let e of c){let t=e-1;t>=0&&(a.set(t,l),e>r&&(r=e))}}if(0===r)return[];let n=Array(r).fill("");for(let[e,t]of a.entries())e<n.length&&(n[e]=t);return n},o=()=>{let[e,t]=(0,s.useState)(!1),[a,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)("✨ Enter book dimensions and start camera for enhanced AR experience"),u="PAGE        Measurements in CM\n# Example pattern below - try PDF import for easier setup!\n17-18        0.5, 7.9, 8.0, 9.6, 9.8, 10.0, 10.1, 20.5\n19-20        0.5, 20.5\n21-22        0.5, 8.4, 8.5, 10.7, 10.9, 20.5",[h,m]=(0,s.useState)({heightCm:0,widthCm:0,paddingTopCm:0,paddingBottomCm:0,instructionsText:u,parsedInstructions:d(u),currentPage:16}),[g,x]=(0,s.useState)({pixelsPerCm:null}),[f,p]=(0,s.useState)({showAllMarks:!0,currentMarkIndex:0}),[b,k]=(0,s.useState)({scale:1,x:0,y:0}),[v,w]=(0,s.useState)(!0),[M,N]=(0,s.useState)("rule-of-thirds"),[C,y]=(0,s.useState)(.4),[P,j]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t(!0)},[]);let A=(0,s.useCallback)(e=>{let t=d(e);m(a=>{let r=a.currentPage;if(r>=t.length||""===t[r]){let e=t.findIndex(e=>""!==e);r=-1!==e?e:0}return{...a,instructionsText:e,parsedInstructions:t,currentPage:r}}),p({showAllMarks:!0,currentMarkIndex:0})},[]),I=(0,s.useCallback)(()=>{if(h.currentPage>=h.parsedInstructions.length)return[];let e=h.parsedInstructions[h.currentPage];return e?e.split(",").map(e=>parseFloat(e.trim())).filter(e=>!isNaN(e)):[]},[h.parsedInstructions,h.currentPage])();(0,s.useEffect)(()=>{p(e=>({...e,currentMarkIndex:Math.min(e.currentMarkIndex,Math.max(0,I.length-1))}))},[I.length,h.currentPage]);let S=(0,s.useCallback)(()=>{m(e=>{for(let t=e.currentPage+1;t<e.parsedInstructions.length;t++)if(e.parsedInstructions[t])return o("✨ Advanced to Page ".concat(t+1," with enhanced AR visualization")),j(!0),setTimeout(()=>j(!1),100),{...e,currentPage:t};return o("Reached the last page with marks (".concat(e.currentPage+1,")")),e}),p({showAllMarks:!0,currentMarkIndex:0})},[o]),D=(0,s.useCallback)(()=>{m(e=>{for(let t=e.currentPage-1;t>=0;t--)if(e.parsedInstructions[t])return o("✨ Viewing Page ".concat(t+1," with enhanced AR features")),j(!0),setTimeout(()=>j(!1),100),{...e,currentPage:t};return o("Already on the first page with marks (".concat(e.currentPage+1,")")),e}),p({showAllMarks:!0,currentMarkIndex:0})},[o]),T=(0,s.useCallback)(e=>{p(t=>{var a,r;if("toggleAll"===e){let e=!t.showAllMarks;return o(e?"✨ Showing all marks with particle effects":"\uD83C\uDFAF Single mark mode with enhanced focus"),j(!0),setTimeout(()=>j(!1),100),{...t,showAllMarks:e}}if("next"===e){let e=t.currentMarkIndex+1;return e>=I.length?(o("\uD83D\uDD04 Cycling to first mark"),{showAllMarks:!1,currentMarkIndex:0}):(o("\uD83D\uDCCF Mark ".concat(e+1,"/").concat(I.length,": ").concat(null==(a=I[e])?void 0:a.toFixed(1),"cm")),{showAllMarks:!1,currentMarkIndex:e})}if("prev"===e){let e=0===t.currentMarkIndex?I.length-1:t.currentMarkIndex-1;return o("\uD83D\uDCCF Mark ".concat(e+1,"/").concat(I.length,": ").concat(null==(r=I[e])?void 0:r.toFixed(1),"cm")),{showAllMarks:!1,currentMarkIndex:e}}return t})},[I.length,o]),E=(0,s.useCallback)(()=>{o("✨ Enhanced AR calibration complete! Particle effects, glassmorphism UI, and grid alignment ready."),j(!0),setTimeout(()=>j(!1),100)},[]);return e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-gray-100",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row min-h-screen",children:[(0,r.jsx)("div",{className:"w-full md:w-96 md:flex-shrink-0",children:(0,r.jsx)(l,{isCameraActive:a,setIsCameraActive:n,pageData:h,setPageData:m,calibrationData:g,setCalibrationData:x,handleInstructionsTextChange:A,statusMessage:i,setStatusMessage:o,transform:b,setTransform:k,markNavigation:f,currentMarksCm:I,handleMarkNavigation:T,handleNextPage:S,handlePrevPage:D,onCalibrate:E,showGrid:v,setShowGrid:w,gridType:M,setGridType:N,gridOpacity:C,setGridOpacity:y})}),(0,r.jsx)("div",{className:"flex-1 bg-gradient-to-b from-black via-gray-900 to-black flex items-center justify-center relative min-h-[400px] md:min-h-screen",children:(0,r.jsx)(c,{isCameraActive:a,calibrationData:g,setCalibrationData:x,pageData:h,marksCm:I,markNavigation:f,transform:b,setTransform:k,setStatusMessage:o,onCalibrate:E,onMarkNavigation:T,onNextPage:S,onPrevPage:D,showGrid:v,gridType:M,gridOpacity:C,triggerParticles:P})})]}),(0,r.jsx)("div",{className:"fixed bottom-4 right-4 bg-black/50 text-white text-xs p-2 rounded opacity-50 pointer-events-none md:hidden",children:"Mobile Layout Active"}),(0,r.jsx)("div",{className:"fixed bottom-4 right-4 bg-black/50 text-white text-xs p-2 rounded opacity-50 pointer-events-none hidden md:block",children:"Desktop Layout Active"})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-white text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-400 border-t-transparent mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-xl",children:"Loading BookfoldAR..."})]})})}}}]);